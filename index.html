<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Forgotten Town</title>
  <style>
    body {
      margin: 0;
      background: #2e2e2e;
      overflow: hidden;
    }

    canvas {
      display: block;
      margin: 0 auto;
      background: #4a4a4a;
      image-rendering: pixelated;
    }
  </style>
</head>
<body>

<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

canvas.width = 360;
canvas.height = 220;

// ===== CONFIG =====
const SCALE = 1.4;           // tamaño del pony
const FRAME_TIME = 60;       // velocidad de animación (ms)
const TOTAL_FRAMES = 16;

// ===== PLAYER =====
const pony = {
  x: canvas.width / 2,
  y: canvas.height / 2,
  speed: 1.5,
  moving: false,
  dir: 1 // 1 = derecha, -1 = izquierda
};

// ===== INPUT =====
const keys = {};
window.addEventListener("keydown", e => keys[e.key] = true);
window.addEventListener("keyup", e => keys[e.key] = false);

// ===== IMÁGENES =====
const standImg = new Image();
standImg.src = "pony-town--stand-acolchado-4x.png";

const walkFrames = [];
for (let i = 0; i < TOTAL_FRAMES; i++) {
  const img = new Image();
  img.src = `sprites/caminar/caminar_${i}.png`;
  walkFrames.push(img);
}

let frame = 0;
let lastFrameTime = 0;

// ===== UPDATE =====
function update(delta) {
  pony.moving = false;

  if (keys["ArrowLeft"]) {
    pony.x -= pony.speed;
    pony.dir = -1;
    pony.moving = true;
  }
  if (keys["ArrowRight"]) {
    pony.x += pony.speed;
    pony.dir = 1;
    pony.moving = true;
  }
  if (keys["ArrowUp"]) {
    pony.y -= pony.speed;
    pony.moving = true;
  }
  if (keys["ArrowDown"]) {
    pony.y += pony.speed;
    pony.moving = true;
  }

  // límites
  pony.x = Math.max(0, Math.min(canvas.width, pony.x));
  pony.y = Math.max(0, Math.min(canvas.height, pony.y));

  // animación
  if (pony.moving && delta - lastFrameTime > FRAME_TIME) {
    frame = (frame + 1) % TOTAL_FRAMES;
    lastFrameTime = delta;
  }

  if (!pony.moving) frame = 0;
}

// ===== DRAW =====
function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  ctx.save();
  ctx.translate(pony.x, pony.y);
  ctx.scale(pony.dir * SCALE, SCALE);

  const img = pony.moving ? walkFrames[frame] : standImg;

  if (img.complete) {
    ctx.drawImage(
      img,
      -img.width / 2,
      -img.height / 2
    );
  }

  ctx.restore();
}

// ===== LOOP =====
let lastTime = 0;
function loop(time) {
  const delta = time;
  update(delta);
  draw();
  requestAnimationFrame(loop);
}

loop();
</script>

</body>
</html>
